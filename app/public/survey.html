<!DOCTYPE html>
<html>

<head>
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <title>FriendFinder Survey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
  <!-- Include my customized styles -->
  <link rel="stylesheet" type="text/css" href="css/stylesheet.css">
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body>
  <div class="row">
    <div class="col s12">
      <div class="card-panel pink center-align">
        <span class="white-text"><h1>Friend Finder</h1></span><br>
        <span class="white-text">There are no wrong answers.  Choose the best answer for you.</span>
      </div>
    </div>
  </div>
  <div class="container left-align">
    <h4>A little about you (required):</h4>
    <div class="row">
      <form class="col s12">
        <div class="row">
          <div class="input-field col s6">
            <i class="material-icons prefix pink-text ">person</i>
            <input placeholder="Name" id="name" id="icon_person" type="text" class="validate" required="" aria-required="true">
            <label for="icon_person">Name</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <i class="material-icons prefix pink-text">face</i>
            <input placeholder="Picture" id="photo" id="icon_face" type="text" class="validate" required="" aria-required="true">
            <label for="icon-face">Picture URL</label>
          </div>
        </div>
    </div>
  </div>

  <div class="container left-align">
    <h4>Survey Questions</h4>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q1">
                  <option value="" disabled selected>Choose your option</option>
                  <option value="1">Star Wars</option>
                  <option value="2">Star Trek</option>
                  <option value="3">The Marvel movies</option>
                  <option value="4">The DC Comics movies</option>
                  <option value="5">The Predator movies</option>
                </select>
        <label>Question 1 - Which of the following sci-fi movie franchises do you like best?</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q2"> 
              <option value="" disabled selected>Choose your option</option>
              <option value="1">Thor</option>
              <option value="2">Superman</option>
              <option value="3">The Hulk</option>
              <option value="4">Wonder Woman</option>
              <option value="5">Batman</option>
            </select>
        <label>Question 2 - Which superhero is the strongest?</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q3">
            <option value="" disabled selected>Choose your option</option>
            <option value="1">Peter Capaldi</option>
            <option value="2">Christopher Eccleston</option>
            <option value="3">Patrick Troughton</option>
            <option value="4">William Hartnell</option>
            <option value="5">Tom Baker</option>
          </select>
        <label>Question 3 - Which Doctor Who do you prefer of the ones listed?</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q4">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">Adam West</option>
        <option value="2">Michael Keaton</option>
        <option value="3">Christian Bale</option>
        <option value="4">Ben Affleck</option>
        <option value="5">George Clooney</option>
      </select>
        <label>Question 4 - Of these Batman actors, which is your favorite?</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q5">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">1 Didn't care</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 Absolutely hated it</option>
      </select>
        <label>Question 5 - How much do you dislike what happened between Kylo Ren and Han Solo in the latest Star Wars entry?</label>
      </div>
    </div>

    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q6">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">Captain Sisqo</option>
        <option value="2">Captain Janeway</option>
        <option value="3">Captain Archer</option>
        <option value="4">Captain Picard</option>
        <option value="5">Captain Kirk</option>
      </select>
        <label>Question 6 - Which Star Trek captain do you like the least?</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q7">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">1 Agree</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 Disagree</option>
      </select>
        <label>Question 7 - You think the recent X-Files revival was as good as the original series.</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q8">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">1 Agree</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 Disagree</option>
      </select>
        <label>Question 8 - You think FireFly deserves a movie franchise.</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q9">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">1 Agree</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 Disagree</option>
      </select>
        <label>Question 9 - You still like to watch the origial Twilight Zone episodes.</label>
      </div>
    </div>
    <div class="row">
      <div class="input-field col s12 m10 l8">
        <select id="q10">
        <option value="" disabled selected>Choose your option</option>
        <option value="1">1 Agree</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 Disagree</option>
      </select>
        <label>Question 10 - You think the Star Wars concept is better than Star Trek concept.</label>
      </div>
    </div>
    <div class="row">
      <a href="#" class="waves-effect waves-light white btn pink-text submit"><i class="material-icons left">check</i>Submit</a>

    </div>
  </div>
  <!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h2>Your Best Match is:</h2>
      <hr>
      <div id="matchPicture"></div>
      <div id="matchName"></div>
    </div>
    <div class="modal-footer">

      <a href="#modal1" class="modal-action modal-close waves-effect waves-green btn-flat">Done</a>
    </div>
  </div>
  <footer class="footer">
    <div class=c ontainer ">
      <a href="/api/friendsList " class="pink-text ">API Friends List</a> | 
      <a href="https://github.com/tbphokie/friendfinder " class="pink-text ">Github Repo</a>
    </div>
  </footer>


  <script type="text/javascript ">
    //<button class="btn waves-effect waves-light pink white-text submit " type="submit " name="action ">Submit</button>         
      $(document).ready(function () {
        $('select').material_select();

        
        //initialize all modals           
        $('.modal').modal();

        //now you can open modal from code
        $('#modal1').openModal();
      });
  </script>

  <script type="text/javascript ">

    //Make sure all inputs have some input
    function validateInput(){

      //Verify inputs here
      var bValid = true;
      //console.log("checking ... " + $('#name').val());
      if($('#name').val() === " " || $('#photo').val() ===" "){
        return false;
      }

      if($('#q1').val() === null || $('#q2').val() === null || $('#q3').val() === null || $('#q4').val() === null || 
        $('#q5').val() === null || $('#q6').val() === null || $('#q7').val() === null ||  $('#q8').val() === null || 
        $('#q9').val() === null || $('#q10').val() === null ){
        return false;
      }

      return bValid;
    }

    //submit survey answers
    $(".submit ").on("click ", function(){

      var bValid =  false;
      bValid = validateInput(); 
      //console.log(bValid);
      if(bValid === true){

        var newFriend = {
          name: $('#name').val(),
          photo: $('#photo').val(),
          scores: [$('#q1').val(), 
            $('#q2').val(), 
            $('#q3').val(), 
            $('#q4').val(), 
            $('#q5').val(), 
            $('#q6').val(), 
            $('#q7').val(), 
            $('#q8').val(), 
            $('#q9').val(),
            $('#q10').val()
          ]
        };

    //    console.log($('#name').val());
    //   console.log($('#photo').val());
    //   console.log($('#q1').val());
    //console.log(newFriend);
        var currentURL = window.location.origin;
        //Now create diffArray to save the differences
        var diffArray = [];
        var diff = [10];    
/*        //Get current friends list data before adding the new one
        $.get(currentURL + "/api/friendslist ", function(data){
          //console.log(data);
          for(var i=0;i<data.length;i++){
            for(var j=0;j<10;j++){
              diff[j] = Math.abs(newFriend.scores[j] - data[i].scores[j]);
              console.log("Friend " + i + ": newFriend score=" + newFriend.scores[j] + " friend score=" + data[i].scores[j]);

            }
            
            diffArray.push(diff.reduce(function(a, b) { return a + b; }, 0));
          }
          //console.log(diffArray);

          var match = 0;
          for(var i=1;i<diffArray.length;i++){
            if(diffArray[i] < diffArray[i-1]){
              match = i;
            }
          }


       });
 */
        $.post(currentURL + "/api/friendslist", newFriend, function(data){ 
          //console.log(" Your match is " + data.name);
          //console.log(data.name);
          //console.log(data.photo);
          //console.log(data);

          if(data === false){
            $('#matchName').append("You are the first to submit your information! No match at this time.");
            
          } else {
            $('#matchName').append(data.name);
            $('#matchPicture').append("<img src='" + data.photo + "' />");             
          }
          $('#modal1').openModal();

          //Clear values 
          /*$('#name').val('');
          $('#photo').val(''); 
          $('select').material_select(); 
          */ 
        }); 
        return true; 
      } else{ 
        alert("All inputs are required, please verify your inputs."); 
      } 
    });


    </script>
  </body>

</html>